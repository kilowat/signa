<!DOCTYPE html>
<html>

<head>
    <title>UI Components Demo</title>
    <link href="styles.css" rel="stylesheet" />
    <script src="../dist/signa.min.js"></script>
</head>

<body>
    <script>
        const { defComponent, defStore, eventBus } = window.signa;

        eventBus.on('counter:changed', (payload) => {
            console.log(payload);
        })

        eventBus.emit('counter:changed', { value: 1 });

        defStore('counterStore', ({ signal }) => {
            const count = signal(0);
            const inc = () => count.value++;
            return {
                count,
                inc,
            }
        })

        defComponent('counter-component', (ctx) => {
            const {
                $this,
                signal,
                effect,
                computed,
                html,
                prop,
                slot,
                render,
                useStore
            } = ctx;
            const header = slot('header');
            const footer = slot('footer');

            const initialValue = prop({
                name: 'initial-value',
                type: Number,
                default: 0
            });

            const count = signal(initialValue.value);
            const counterStore = useStore('counterStore');

            effect(() => {
                console.log('mount');
                return () => console.log('unmount');
            })

            effect(() => {
                console.log("Whatch value " + count);
            })

            return () => html`
                <div>
                    <header>${header}</header>
                    <main>${slot.default}</main>
                    <footer>${footer}</footer>
                </div>
                <div>
                    Count: ${count.value}
                    <button onclick=${() => count.value++}>Increment</button>
                </div>
                <div>
                    CountStore: ${counterStore.count.value}
                    <button onclick=${() => counterStore.inc()}>Increment</button>
                </div>
            `;
        });
    </script>
    <h1>Component Examples</h1>
    <counter-component data-initial-value="4">
        <div data-slot="header"><b>Header content</b></div>
        <b>default slot</b>
        <div data-slot="footer">Footer content</div>
    </counter-component>

</body>


</html>